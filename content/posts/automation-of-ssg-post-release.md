---
title:     "Automation of Ssg Post Release"
date:      2025-04-25T15:43:45+08:00
draft:     false
summary:   ""
categories:
  - SDS
tags: [å¸®åŠ©]

---



# SSG (Hugo + Cloudflare) å¦‚ä½•å®ç°åŠè‡ªåŠ¨åŒ–ï¼Ÿ



ä½ ç°åœ¨èƒ½çœ‹åˆ°è¿™ç¯‡å¸–å­ï¼Œè¯´æ˜æˆ‘å·²ç»å¯ä»¥ç”¨ä¸€è¡Œä»£ç ï¼Œå…å»æ‰‹åŠ¨å»º markdown æ–‡ä»¶ã€æ— éœ€æ‰‹å†™ Front Matterã€ä¹Ÿä¸ç”¨åœ¨ç»ˆç«¯å†™ git å‘½ä»¤â€”â€”ä¸€é”®å‘å¸ƒ postã€‚

æˆ‘å‘ç°åœ¨é™æ€ç½‘é¡µå‘å¸ƒæ–‡ç« æ¯æ¬¡éƒ½è¦è€—è´¹ä¸ç›¸å…³ä¸”é‡å¤æ€§åŠ³åŠ¨ï¼Œé‚è¯•å›¾æ¶ˆç­è¿™äº›éº»çƒ¦ã€‚



## Instructions



1. åœ¨é¡¹ç›®æ ¹ç›®å½• (git ä»“åº“æ ¹ç›®å½•) ä¸‹å»ºç«‹ shell æ–‡ä»¶ (ä»¥ä¸‹ç§°ä¸º â€œnewpost.sh")ã€‚

2. (åˆ›å»ºå¹¶) ä¿®æ”¹ archetypes/default.md ä¸ºä½ æƒ³ç”¨çš„ front matterï¼Œæ¯”å¦‚ï¼š

   ```yaml
   ---
   title:     "{{ replace .Name "-" " " | title }}"
   date:      {{ .Date }}
   draft:     false
   summary:   ""
   categories: []
   tags:       []
   ---
   ```

   æˆ–è€…ä½ ç”¨çš„æ˜¯ TOMLï¼š

   ```toml
   +++
   title      = "{{ replace .Name \"-\" \" \" | title }}"
   date       = {{ .Date }}
   draft      = false
   summary    = ""
   categories = []
   tags       = []
   +++
   ```

   å…¶ä¸­åŒå¼•å·å’Œæ–¹æ‹¬å·æ˜¯å ä½ç¬¦ï¼Œå¦‚æœä½ æœ‰å›ºå®šæ ¼å¼æˆ–å†…å®¹è¦æ±‚ï¼Œå¯ä»¥ç›´æ¥å¡«å…¥ã€‚

3. ç„¶ååœ¨ â€œnewpost.shâ€ ä¸­å¡«å…¥ä»¥ä¸‹ä¿¡æ¯ï¼š

   ```shell
   #!/usr/bin/env bash
   
   set -euo pipefail
   
   # â€”â€” 1. å‚æ•°æ£€æŸ¥ â€”â€” #
   if [ $# -lt 1 ]; then
     cat << EOF
   Usage: $0 "æ–‡ç« æ ‡é¢˜" [æ ‡ç­¾1,æ ‡ç­¾2,...]
   
   ç¤ºä¾‹:
     $0 "ä¸ºä»€ä¹ˆçº¿æ€§ä»£æ•°å¥½æœ‰è¶£" math,linear-algebra
   EOF
     exit 1
   fi
   
   TITLE="$1"
   TAGS="${2:-}"   # å¦‚æœåªä¼ æ ‡é¢˜ï¼ŒTAGS åˆ™ä¸ºç©º
   
   # â€”â€” 2. ç”Ÿæˆ slug â€”â€” #
   SLUG=$(echo "$TITLE" \
     | tr '[:upper:]' '[:lower:]' \
     | sed -E 's/[^a-z0-9]+/-/g' \
     | sed -E 's/^-+|-+$//g')
   
   FILE="content/posts/${SLUG}.md"
   
   # â€”â€” 3. Hugo æ–°å»ºæ–‡ç«  â€”â€” #
   hugo new posts/${SLUG}.md
   
   # â€”â€” 4. æ›¿æ¢ tags å­—æ®µ â€”â€” #
   if [ -n "${TAGS}" ]; then
     # macOS ä¸‹ sed ç”¨ -i ''ï¼ŒLinux ä¸‹å¯æ”¹æˆ sed -i
     sed -i '' "s/^tags:.*/tags: [${TAGS}]/" "${FILE}"
   fi
   
   # â€”â€” 5. æ‰“å¼€ Typora â€”â€” #
   echo "ğŸš€ å·²åˆ›å»ºæ–‡ä»¶ï¼š${FILE}"
   echo "   æ­£åœ¨ç”¨ Typora æ‰“å¼€â€¦â€¦"
   open -a "Typora" "${FILE}"
   
   # â€”â€” 6. ç­‰å¾…ç”¨æˆ·åœ¨ Typora ä¸­ç¼–è¾‘å®Œæˆåï¼Œå›åˆ°ç»ˆç«¯æŒ‰å›è½¦ â€”â€” #
   read -rp "âœï¸  ç¼–è¾‘å®Œæˆåï¼Œå›åˆ°æ­¤å¤„æŒ‰å›è½¦ç»§ç»­æäº¤å¹¶æ¨é€â€¦"
   
   # â€”â€” 7. Git æäº¤å¹¶æ¨é€ â€”â€” #
   git add "${FILE}"
   git commit -m "feat: æ–°å¢æ–‡ç« ã€Š${TITLE}ã€‹"
   git push -u origin main
   
   echo "âœ… å·²æäº¤å¹¶æ¨é€ï¼š${FILE}"
   ```

4. èµ‹äºˆç»ˆç«¯è®¿é—®è¿è¡Œæƒï¼š`chmod +x newpost.sh`

5. æœ€åï¼Œéœ€è¦å‘è¡¨æ–‡ç« æ—¶ï¼Œè¾“å…¥`./newpost.sh "<æ–‡ç« æ ‡é¢˜>" <æ ‡ç­¾1>,<æ ‡ç­¾2>,â€¦â€¦` ï¼Œéšå typora ä¼šè·³å‡ºï¼Œå†™å…¥æ­£æ–‡å†…å®¹åï¼Œctrl+sï¼Œç‚¹å‡»å…³é—­çª—å£ï¼Œæ–¹æ‰ç¼–è¾‘çš„æ–‡ä»¶å°±ä¼šè‡ªåŠ¨å‘å¸ƒã€‚



ç°åœ¨â€¦â€¦æˆ‘ç‚¹å‡»å…³é—­çª—å£ï¼Œç¨åå†è§ã€‚ï¼ˆä¸æ˜¯åœ¨è·Ÿä½ è¯´ï¼Œä½ å¿«è‡ªå·±å»è¯•è¯•å§ï¼‰
